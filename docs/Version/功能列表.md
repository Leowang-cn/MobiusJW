# 主界面main.py
## 界面样式
整体布局：窗口采用垂直布局，顶部为 LOGO 和标题区域（居中显示），下方为主功能按钮网格（两行排列）。窗口尺寸固定为 1000x600，位置偏移 (100,100)，最小尺寸 800x500，支持用户调整大小。
视觉元素：
LOGO：从 assets/logo.png 加载，动态缩放至宽度 100px（保持比例），居中显示。若加载失败，静默跳过（控制台打印错误）。
标题与版本：标题 "MobiusJ" 使用大字体（30pt，深灰色 #2c3e50），版本 "V0.0.9" 使用小字体（14pt，浅灰色 #666666），垂直居中对齐。
按钮网格：第一行 6 个按钮（题目录入、题目管理、题目查询、标签管理、题簇管理、学生管理），第二行 2 个按钮（判断题、设置）。按钮使用网格布局，水平/垂直间距 10px，尺寸缩减至原三分之二（ipadx/ipady 调整）。
样式设计：采用 ttk.Style() 自定义按钮外观，主题 'default'，字体 ".SF NS Text"（macOS 兼容），前景色深灰 #333333，背景浅蓝 #e6f0fa，无边框，焦点色蓝 #2980b9。悬停时背景变浅 #f5faff，前景色变蓝 #2980b9，激活/按下时颜色渐变，提供现代扁平化视觉效果。
## 交互逻辑
按钮交互：每个按钮绑定独立命令函数（e.g., on_question_entry 调用 feature1.question_entry()），点击后执行相应模块功能，无返回值。按钮支持键盘/鼠标焦点，点击后立即触发，无额外确认。
悬停效果：鼠标进入按钮时切换至 "Hover.TButton" 样式（背景/前景色变化），离开时恢复原样式，增强用户反馈。
窗口行为：窗口可拖拽调整大小，最小尺寸限制防止过度缩小。关闭窗口时退出应用（root.mainloop()）。
资源处理：使用 resource_path() 函数动态获取资源路径，支持 PyInstaller 打包后正确加载 LOGO（优先 sys._MEIPASS，否则当前目录）。
错误容错：LOGO 加载失败时不影响界面显示，仅打印错误信息。无其他异常处理，假设依赖模块正常导入。


# config.py
## 界面样式
无界面：此代码为纯后端配置文件管理模块，无 GUI 界面或视觉元素。所有操作通过函数调用进行，不涉及 Tkinter 或其他 UI 库。
## 交互逻辑
路径确定：启动时根据 sys.frozen 判断是否为打包环境，动态设置 APP_DIR（程序目录）和 SETTINGS_FILE（settings.json 路径），确保开发/打包环境兼容。
文件初始化：ensure_settings_file() 检查设置文件是否存在，若不存在则创建默认配置（包含 "data_path"、"subjects"、"subject_param" 键），调用 save_settings() 写入 JSON 文件。
配置读取：load_settings() 读取 JSON 文件，返回字典；若文件不存在，返回默认空配置。支持 UTF-8 编码。
配置保存：save_settings(settings) 将字典序列化为 JSON（缩进 4 空格），写入文件。无返回值，假设操作成功。
路径获取：load_settings_path() 返回设置文件绝对路径，用于其他模块引用。
错误处理：无显式异常捕获，依赖文件系统权限；读取失败时返回默认值，避免崩溃。整体逻辑简单、原子化，确保配置持久化。
## 作用
路径管理：根据运行环境（开发或打包）动态确定程序目录和设置文件路径，确保兼容性。
文件初始化：检查 settings.json 是否存在，若不存在则自动创建默认配置（包含数据路径、科目列表等键）。
配置操作：提供读取（load_settings）和保存（save_settings）JSON 配置的功能，支持 UTF-8 编码和格式化输出。
路径暴露：通过 load_settings_path 返回设置文件路径，供其他模块使用。

# 题目录入feature1.py
## 界面样式
整体布局：窗口为固定尺寸（1800x930）的 Toplevel，水平分为四个区域：左侧 tag_frame（600px，标签详情）、中左 type_frame（600px，题目输入）、中右 img_frame（600px，图片预览）、底部 stance_frame（1800px，操作按钮）。各框架使用边框和 place() 定位，无滚动条。
视觉元素：
tag_frame：模块类型/名称下拉框（Combobox）、标签名称输入框（Entry）、简介多行文本框（Text）、题目表格（Treeview，列：题目ID、图片，高度20行）。
type_frame：题目ID输入框（Entry）+粘贴按钮、难度下拉框（Combobox，1-5级）、选中标签按钮组（动态Button）、标签查询输入框（Entry）+创建/刷新按钮、标签表格（Treeview，列：类型、模块、题量、名称、介绍，列宽固定）。
img_frame：图片预览区域（由 ImageFrame 封装，显示图片/尺寸信息）。
stance_frame：保存/清空按钮（Button，宽度20）。
弹窗样式：创建标签弹窗（600x400）使用 Frame/grid 布局，模块选择行（Label+Combobox+Button）、名称/介绍行（Label+Entry/Text），按钮居下。添加/删除模块弹窗（400x340）包含类型下拉和多行文本输入。
样式细节：使用 ttk 组件（Treeview、Combobox），按钮宽度固定（e.g., 10-20），表格列宽指定（e.g., 70-200px），无自定义颜色/字体，简洁扁平化设计。
## 交互逻辑
数据初始化：启动时加载标签/题目/模块数据，填充全局变量和表格；若数据库路径无效，弹出错误提示。
题目输入：输入题目ID 后回车，自动检查格式/存在性，若存在则填充标签/难度/图片（从 item_img_path 加载），并聚焦查询框；若不存在，聚焦查询框。
标签管理：查询输入框实时过滤表格；回车若匹配唯一则选择，若无匹配则弹出创建标签弹窗（预填名称）；双击表格行切换选中状态，更新选中标签显示（动态按钮，双击取消）。创建标签弹窗支持选择模块（下拉联动）、输入名称/简介，保存后刷新数据；弹窗内可批量添加/删除模块（子弹窗解析文本输入）。
表格交互：标签表格选择行更新 tag_frame 详情（模块下拉联动）；题目表格双击打开网页，右键菜单（复制ID、预览图片），选择行自动预览图片（从 img_dir 加载）。
保存逻辑：验证题目ID/标签/难度，保存题目数据（items/item_tag_relations 表）和图片（若有则复制到 item_img_path），刷新标签数据，清空字段。
清空逻辑：重置所有输入框、下拉框、选中标签、图片预览，刷新表格。
图片处理：支持粘贴图片（从剪贴板），自动调整尺寸显示；保存时若有图片则写入目录。
事件绑定：输入框绑定回车处理，按钮绑定命令，表格绑定选择/双击/右键事件；模块类型下拉联动刷新模块名称。

# 标签管理feature2.py
## 界面样式
整体布局：主窗口为 Toplevel（900x800），顶部筛选区域（filter_frame，使用 grid 布局），下方表格区域（tags_table，使用 pack 填充）。弹窗使用 Toplevel，尺寸固定（编辑弹窗 650x300，查看题目弹窗 450x400）。
视觉元素：
筛选区域：一行横向排列模块类型下拉框（Combobox，宽度8）、模块下拉框（宽度10）、标签名称输入框（Entry，宽度20）、刷新按钮（Button，宽度8）。标签使用 grid，间距紧凑（padx 2-10）。
表格：Treeview，列标题：模块类型、模块、题量、名称、介绍；列宽：100、100、50、150、200px。无边框，填充窗口。
编辑弹窗：顶部显示题目数量标签（蓝色），中间一行 Frame 包含模块类型/模块/名称输入（Combobox/Entry），下方介绍文本框（Text，70x8），底部按钮行（查看/保存/删除/取消，宽度10）。
查看题目弹窗：顶部标签，下方 Listbox（宽度40，高度12，多选），底部按钮行（复制/打开/关闭，宽度10）。
样式细节：使用 ttk 组件（Combobox、Treeview），按钮宽度固定，无自定义颜色/字体，简洁网格布局，弹窗居中显示。
## 交互逻辑
数据初始化：启动时加载标签/题目/模块数据，填充全局变量；若数据库路径无效，弹出错误提示。
筛选交互：模块类型下拉联动刷新模块选项（仅显示该类型模块）；模块/标签名称输入实时过滤表格（KeyRelease 事件）；刷新按钮重置筛选并重新加载数据。
表格交互：双击行弹出编辑弹窗；表格更新时统计题量（查询 item_tag_relations）。
编辑逻辑：弹窗预填当前标签数据，模块类型下拉联动刷新模块选项；保存时验证字段唯一性，更新数据库并刷新表格；删除时检查题量（>0 则阻止）。
查看题目：弹窗列出该标签的题目ID（Listbox），支持多选复制到剪贴板或打开网页（使用 subject_param 构建 URL）。
事件绑定：下拉框绑定 <<ComboboxSelected>> 联动，输入框绑定 <KeyRelease> 过滤，表格绑定 <Double-1> 编辑，按钮绑定 command 执行操作。

# 学生管理feature3.py
## 界面样式
整体布局：主窗口为 Toplevel（600x400），顶部添加学生按钮，中间筛选区域（filter_frame），下方表格（tree，使用 pack 填充）。弹窗使用 Toplevel，尺寸固定（添加学生 300x150，学生题目 1000x400）。
视觉元素：
筛选区域：水平排列标签、输入框（Entry，宽度20）、查询按钮（Button）。
表格：Treeview，列标题：学生姓名、关联题目数量；高度15行，填充窗口，列宽默认。
添加学生弹窗：垂直布局，标签、输入框（宽度20）、保存按钮。
学生题目弹窗：使用 Canvas + Scrollbar 实现滚动区域，每行 Frame 包含信息标签（左对齐）和按钮组（右对齐，查看/删除按钮宽度4，间距4px）。
样式细节：使用 ttk.Treeview，按钮宽度固定，无自定义颜色/字体，简洁 pack/grid 布局，弹窗居中显示，支持滚动。
## 交互逻辑
数据初始化：启动时检查数据库表（students、student_item_relations）存在性，查询学生列表和关联题目数量，填充表格。
筛选交互：输入学生姓名，点击查询按钮模糊搜索并刷新表格。
表格交互：双击行弹出学生题目弹窗，显示该学生的题目列表（按日期降序）。
添加学生：弹窗输入姓名，验证非空/长度≤10/唯一性，生成6位ID插入数据库，成功后刷新主表格。
题目操作：每行显示题目ID和创建日期，查看按钮打开网页（使用 subject_param 构建 URL），删除按钮确认后解除关联并刷新。
事件绑定：表格绑定 <Double-1> 双击，按钮绑定 command 执行操作。弹窗使用 grab_set() 模态显示。

# 设置feature4.py
## 界面样式
整体布局：主窗口为 Toplevel（600x600），垂直布局，不可调整大小。顶部显示当前数据位置和学科参数，中间按钮区域（Frame），下方学科参数输入区域（标签、输入框、保存按钮）。
视觉元素：
显示标签：数据位置和学科参数使用 Label 显示当前值。
按钮区域：Frame 水平排列“设置”和“校验”按钮（Button）。
输入区域：学科参数标签（Label）、输入框（Entry，宽度25）、保存按钮（Button）。
样式细节：使用默认 Tkinter 组件，无自定义字体/颜色，简洁 pack 布局，窗口居中显示。
## 交互逻辑
数据路径设置：点击“设置”按钮打开文件夹选择对话框，选择后保存到 settings.json，自动创建 item_img_path 文件夹，校验数据库结构（若缺失表则询问补全）。
数据路径校验：点击“校验”按钮检查路径、文件夹存在性和数据库结构，缺失时提示补全或报错。
学科参数保存：输入框输入参数，点击“保存”按钮验证非空，保存到 settings.json，更新显示标签，失败时回滚并显示错误详情。
数据库管理：后台函数创建空数据库（12张表）、校验表/字段存在性、自动补全缺失表。所有操作使用 SQLite，包含约束检查。
事件绑定：按钮绑定 command 执行操作，窗口关闭时销毁。弹窗使用 messagebox 显示信息/错误/确认。

# 题簇管理feature5.py
## 界面样式
整体布局：主窗口为 Toplevel（1100x600），顶部查询区域（LabelFrame），下方表格（Treeview，使用 pack 填充）。弹窗使用 Toplevel，尺寸固定（添加/编辑题簇 580x640，题组编辑 850x420，题目列表 650x420）。
视觉元素：
查询区域：一行横向排列模块/标签下拉框（Combobox，宽度18）、题簇名称输入框（Entry，宽度18）、查询/添加按钮（Button，宽度7）。使用 grid 布局，间距紧凑。
表格：Treeview，列标题：模块类型、模块名称、标签名称、题簇名称、题组数量、各层次数量（基础/进阶/疯狂/暴躁）、题簇介绍；列宽：120-220px。无边框，填充窗口。
添加/编辑弹窗：顶部模块/标签选择（Combobox，宽度18）、名称输入（Entry，宽度22）、介绍文本框（Text，高度6，宽度32）；中间题组列表（Frame + Label/Button 网格，显示名称/层次/数量/操作）；底部添加题组/保存按钮（宽度10）。
题组编辑弹窗：顶部名称/层次/介绍输入（Entry/Combobox，宽度20-30）；下方例题/练习文本框（Text，高度14，宽度56），左右并列；底部保存按钮。
题目弹窗：垂直列表每行 Frame 包含题目ID标签（宽度50）和查看/标记按钮（宽度4，间距2px）。
样式细节：使用 ttk 组件（Combobox、Treeview、Entry），按钮宽度固定，无自定义颜色/字体，简洁 grid/pack 布局，弹窗居中显示，支持滚动（题目弹窗无显式滚动）。
## 交互逻辑
数据初始化：启动时加载模块/标签/题簇数据，填充下拉框/表格；若无模块，禁用控件并提示。
查询交互：模块下拉联动刷新标签选项，输入题簇名称过滤表格，显示题组总数和各层次数量；查询按钮刷新结果，无数据时显示提示行。
添加题簇：弹窗预选模块联动标签，输入名称/介绍，添加题组（弹窗编辑，检查题目ID冲突），保存生成ID插入数据库，刷新主表格。
编辑题簇：双击表格行弹出编辑弹窗，预填数据，修改题组（添加/编辑/删除，冲突检查），保存更新数据库。
题组管理：添加/编辑弹窗中添加题组（弹窗输入名称/层次/介绍/题目ID），双击数量标签弹出题目列表（查看网页或标记学生关联），删除题组检查冲突。
题目操作：题目弹窗每行查看按钮打开网页，标记按钮弹出学生选择下拉，确认后插入学生题目关系。
事件绑定：下拉框绑定 <<ComboboxSelected>> 联动，表格绑定 <Double-1> 编辑，标签绑定 <Double-Button-1> 查看，按钮绑定 command 执行操作。弹窗使用 grab_set() 模态，关闭时销毁。

# 题目管理item_management.py
## 界面样式
整体布局：主窗口为 Toplevel（1800x1000），左侧搜索框架（1200px，垂直填充），右侧图片框架（600px，使用 ImageFrame）。弹窗使用 Toplevel，尺寸固定（详情弹窗 600x500）。
视觉元素：
搜索区域：水平排列标签、输入框（Entry，宽度36）、检索按钮（Button）。
筛选区域：选中标签 Listbox（高度4，宽度38，多选），模块类型/名称/标签下拉框（Combobox，宽度10-18）、添加标签按钮（宽度10），难度/用途下拉框（宽度8）、查询/刷新按钮。
表格：Treeview，列标题：模块类型、模块名称、标签、题目ID、题目难度、题目用途、讲解思路；列宽：60-260px。无边框，填充窗口。
详情弹窗：grid 布局，标签展示区（Frame + Label/Button）、模块类型/名称/标签下拉框（宽度10-18）、题目ID只读标签 + 查看按钮、难度/用途下拉框（宽度8）、讲解思路文本框（Text，宽度40，高度6）、保存/取消/删除按钮（宽度10）。
样式细节：使用 ttk.Treeview/Combobox，按钮宽度固定，无自定义颜色/字体，简洁 pack/grid 布局，弹窗居中显示。
## 交互逻辑
数据初始化：启动时加载模块/标签数据，填充下拉框；默认刷新表格显示所有题目。
检索/筛选：输入题目ID模糊搜索；下拉框联动（模块类型限制模块名称，模块名称限制标签），添加标签到 Listbox（双击移除），查询按钮按标签交集/难度/用途过滤表格，刷新按钮重置所有筛选。
表格交互：双击行打开网页，选择行/右键加载图片到右侧框架（自动缩放/预览弹窗）。
详情编辑：双击表格弹出详情弹窗，显示当前标签（带删除按钮），编辑下拉框联动，保存更新数据库（items/item_tag_relations 表），删除题目（确认后删除记录）。
图片处理：选择题目时从 item_img_path 加载图片，缩放显示，支持多种格式；失败时显示默认文本。
事件绑定：下拉框绑定 <<ComboboxSelected>> 联动，Listbox 绑定 <Double-Button-1> 移除，表格绑定 <Double-1> 详情/<Button-3> 图片/<<TreeviewSelect>> 加载图片，按钮绑定 command 执行操作。弹窗使用 grab_set() 模态。

# 题目查询item_query.py
## 界面样式
整体布局：主窗口为 Toplevel（1800x1000），左侧主框架（填充），右侧图片框架（600px，使用 ImageFrame）。主框架垂直分为筛选区域、统计区域（分布文案 + 表格 + 题目清单）。
视觉元素：
筛选区域：一行横向排列模块类型/名称/标签下拉框（Combobox，宽度12-18）、查询按钮（Button，宽度12）。使用 grid 布局，字体 "微软雅黑"。
统计区域：顶部分布文案（Label），中间分布表格（Treeview，列：模块类型、模块、标签、题目数量，宽度200px），下方题目清单表格（Treeview，列：题目ID，宽度750px） + 右侧标签展示区（Frame + Label）。
图片框架：显示图片/尺寸信息，支持预览。
样式细节：使用 ttk.Treeview/Combobox，字体 "微软雅黑"（10pt），按钮宽度固定，无自定义颜色/字体，简洁 pack/grid 布局，表格高度固定（10-12行）。
## 交互逻辑
数据初始化：启动时加载标签/模块数据，填充下拉框；默认不查询。
筛选交互：下拉框联动（模块类型限制模块名称，模块名称限制标签），查询按钮计算选中标签的分布（1/2/3个标签数量），填充分布表格和文案。
表格交互：选择分布行显示对应题目ID列表，双击题目ID打开网页，右键复制ID，选择题目ID加载图片到右侧框架并显示标签列表。
图片处理：选择题目时从 item_img_path 加载图片，缩放显示，支持预览弹窗；失败时显示默认文本。
事件绑定：下拉框绑定 <<ComboboxSelected>> 联动，表格绑定 <<TreeviewSelect>> 显示ID/<Double-1> 网页/<Button-3> 复制，按钮绑定 command 执行查询。弹窗使用短暂提示（右键复制）。

# 判断题TF_Question_Manager.py
## 界面样式
整体布局：主窗口为 Toplevel（900x600），垂直布局，不可调整大小。顶部添加按钮，中间筛选区域（LabelFrame），下方表格（Treeview，使用 pack 填充）。
视觉元素：
筛选区域：一行横向排列模块类型/名称/标签下拉框（Combobox，宽度10-15）、查询/重置按钮（Button）。
表格：Treeview，列标题：标签名称、判断题目、答案；列宽200px，隐藏 TF_question_id 列。
编辑弹窗：grid 布局，模块类型/名称/标签下拉框（宽度12-18）、题目输入框（Entry，宽度40）、答案单选按钮（Radiobutton）、保存/删除按钮。
批量添加弹窗：垂直布局，多行文本输入（Text，高度4）、下拉框（Combobox，宽度10-15）、动态行容器（Frame，每行包含下拉框/输入框/单选按钮）、解析/保存/清空按钮。
样式细节：使用 ttk.Treeview/Combobox，按钮宽度固定，无自定义颜色/字体，简洁 pack/grid 布局，弹窗居中显示。
## 交互逻辑
数据初始化：启动时查询所有判断题，填充表格；下拉框加载模块/标签数据。
筛选交互：下拉框联动（模块类型限制模块名称，模块名称限制标签），查询按钮按条件过滤表格，重置按钮清空筛选并刷新。
表格交互：双击行弹出编辑弹窗，预填数据并联动下拉框。
编辑逻辑：弹窗验证输入，保存更新 TF_questions/TF_tag_relations 表，删除确认后删除记录，成功后刷新主表格。
批量添加：输入多行题干，解析生成动态行（每行独立联动下拉框），保存验证后批量插入数据库（生成唯一 ID），清空后重置。
事件绑定：下拉框绑定 <<ComboboxSelected>> 联动，表格绑定 <Double-1> 编辑，按钮绑定 command 执行操作。弹窗使用 grab_set() 模态。

# 通用模块1——题目图片预览交互item_management.py
## 界面样式
整体布局：Frame（固定宽度/高度），垂直布局。顶部操作行（Frame），下方图片显示区（Label，使用 pack 填充）。
视觉元素：
操作行：水平排列“粘贴图片”按钮（Button，宽度10）和尺寸标签（Label，宽度18，右对齐）。
图片显示区：Label，初始显示灰色背景文本“此处为图片粘贴区域”，双击触发预览；显示图片时居中缩放。
预览弹窗：Toplevel（900x900，可调整大小），Canvas（黑色背景）显示图片，支持缩放/拖动/选区。
样式细节：使用 tk.Frame/Label/Button/Canvas，无自定义颜色/字体，简洁 pack 布局，弹窗居中显示。
## 交互逻辑
粘贴图片：点击按钮从剪贴板获取图片，缩放适应显示区，更新 Label 显示和尺寸标签；失败时弹出错误提示。
双击预览：Label 双击弹出弹窗，Canvas 显示原图（初始缩放适应宽度），支持鼠标滚轮缩放（0.1-10倍）、左键拖动位置、右键拖动选区（红色框）。
选区复制：右键释放后裁剪选区图片，复制到剪贴板（仅 macOS 支持），显示短暂提示；失败时弹出错误。
事件绑定：按钮绑定 command 粘贴，Label 绑定 <Double-1> 预览，Canvas 绑定 <Configure> 重绘/<MouseWheel> 缩放/<ButtonPress-1> 开始拖动/<B1-Motion> 拖动/<ButtonPress-3> 开始选区/<B3-Motion> 选区拖动/<ButtonRelease-3> 选区释放复制。弹窗双击关闭。

# 通用模块2——拼接网址view_item.py
## 界面样式
无界面：此代码为纯后端工具模块，无 GUI 界面或视觉元素。所有操作通过函数调用进行，不涉及 Tkinter 或其他 UI 库。
## 交互逻辑
URL 生成：函数 open_question_url(question_id) 从 settings.json 获取 subject_param，若未设置则返回；否则拼接 URL https://www.jyeoo.com/{subject}/ques/detail/{question_id}。
浏览器打开：使用 webbrowser.open(url) 在默认浏览器中打开页面，无返回值。
错误处理：若 subject_param 缺失，静默跳过；依赖 config.load_settings() 获取配置。